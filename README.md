# Pipeline-project
Snakemake pipeline for HCMV transcriptome analysis. Automates quantification, differential expression, assembly, and strain comparison using kallisto, sleuth, Bowtie2, SPAdes, and BLAST. Includes test data and full documentation for reproducible runs.

## The pipeline automates the following tasks:
1. Retrieve and process HCMV reference genome from NCBI.
2. Build a transcriptome index for HCMV CDS and quantify transcript abundances using kallisto.
3. Differential expression analysis using R / sleuth.
4. Filter reads mapping to HCMV genome using Bowtie2.
5. Assemble filtered reads with SPAdes.
6. Identify closest viral strains by BLASTing the longest contigs against a local 7. Betaherpesvirinae database.
8. Generate a consolidated report (PipelineReport.txt) containing CDS counts, read mapping statistics, significant transcripts, and BLAST hits.

## Repository Structure
.
├── Snakefile                    # Main Snakemake workflow
├── scripts/                     # Python & R helper scripts
│   ├── make_cds_fasta.py
│   ├── get_longest_contig_from_assembly.py
│   └── sleuth.R
├── fastq/                        # Input FASTQ files (paired-end)
│   ├── SRR5660030_1.fastq
│   ├── SRR5660030_2.fastq
│   ├── SRR5660033_1.fastq
│   └── ...
├── ref/                          # HCMV reference genome & CDS
├── indexes/                      # kallisto & Bowtie2 indices
├── results/                      # Output: counts, kallisto results, sleuth results
├── spades/                       # SPAdes assemblies
├── blast/                        # Longest contigs & BLAST results
├── db/                           # Local Betaherpesvirinae BLAST database
├── counts/                       # Read counts per sample
└── PipelineReport.txt            # Final report (generated by pipeline)

## To run this pipeline, the following tools must be installed:
Python 
Snakemake
Biopython
R 4 with sleuth package
kallisto
Bowtie2
samtools
SPAdes
BLAST+
NCBI datasets CLI

# Test Data

## The repository includes a subset of paired-end FASTQ files from SRA:

Sample ID	Description
SRR5660030	Donor 1, 2 dpi
SRR5660033	Donor 1, 6 dpi
SRR5660044	Donor 3, 2 dpi
SRR5660045	Donor 3, 6 dpi

Each test file contains ~10,000 reads for quick pipeline verification.

# Running the Pipeline

## After cloning the repository:

```bash
git clone <your_repo_url>
cd <repo_folder>
```

## Run the entire pipeline with test data:

```bash
snakemake --cores 4
```
This command executes all rules from the Snakefile, generating:
PipelineReport.txt
Kallisto indices and quantifications
Sleuth results
Bowtie2 mapped BAM files
SPAdes assemblies
BLAST results

View the final report:
```bash
cat PipelineReport.txt
```

To remove all intermediate and output files:
```bash
snakemake cleanup
```

## Downloading SRA Data
Raw transcriptome data were retrieved from NCBI SRA using fasterq-dump. 
```bash
fasterq-dump SRR5660030 --split-files --outdir fastq
fasterq-dump SRR5660033 --split-files --outdir fastq
fasterq-dump SRR5660044 --split-files --outdir fastq
fasterq-dump SRR5660045 --split-files --outdir fastq
```
